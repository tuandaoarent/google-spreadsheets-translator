<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.3.2/css/flag-icons.min.css" />
  <?!= include('Stylesheet'); ?>
</head>

<body>
  <div class="main-content">
    <!-- Translation Section -->
    <h2 class="section-title">Translation</h2>

    <div class="language-group" id="sourceLanguageGroup">
      <label class="language-label">Source language</label>
      <div class="language-select">
        <div class="language-input" onclick="toggleSourceDropdown()">
          <span class="language-icon"></span>
          <span class="language-text"></span>
          <span class="dropdown-arrow">⏷</span>
        </div>
        <div class="dropdown-menu">
          <div class="filter-container">
            <div class="input-wrapper">
              <input type="text" class="language-filter" placeholder="Search languages..." onkeyup="filterLanguages('source', this.value)">
              <button type="button" class="clear-filter" onclick="clearFilter('source')" title="Clear search">
                <span class="clear-icon">×</span>
              </button>
            </div>
          </div>
          <div class="language-options">
            <!-- Source language options will be populated by JavaScript -->
          </div>
          <div class="no-results" style="display: none;">
            <div class="no-results-message">No languages found</div>
          </div>
        </div>
      </div>
    </div>

    <div class="language-group" id="targetLanguageGroup">
      <label class="language-label">Target language</label>
      <div class="language-select">
        <div class="language-input" onclick="toggleTargetDropdown()">
          <span class="language-icon"></span>
          <span class="language-text"></span>
          <span class="dropdown-arrow">⏷</span>
        </div>
        <div class="dropdown-menu">
          <div class="filter-container">
            <div class="input-wrapper">
              <input type="text" class="language-filter" placeholder="Search languages..." onkeyup="filterLanguages('target', this.value)">
              <button type="button" class="clear-filter" onclick="clearFilter('target')" title="Clear search">
                <span class="clear-icon">×</span>
              </button>
            </div>
          </div>
          <div class="language-options">
            <!-- Target language options will be populated by JavaScript -->
          </div>
          <div class="no-results" style="display: none;">
            <div class="no-results-message">No languages found</div>
          </div>
        </div>
      </div>
    </div>

    <!-- HTML Template for dropdown items -->
    <template id="dropdownItemTemplate">
      <div class="dropdown-item" data-code="">
        <span class="language-icon fi"></span>
        <div class="country-code"></div>
        <span class="language-name"></span>
      </div>
    </template>

    <button class="translate-button" onclick="translateContent()">TRANSLATE</button>

    <div id="status" class="status" onclick="hideStatus()"></div>

    <!-- Advanced Settings Section -->
    <div class="advanced-settings">
      <h2 class="advanced-title">
        <span class="gear-icon">⚙️</span>
        Advanced settings
      </h2>

      <div class="setting-item">
        <span class="setting-label">Translate full sheet</span>
        <div class="toggle-switch" id="fullSheetToggle" onclick="toggleSetting(SETTING_NAMES.FULL_SHEET)">
          <div class="toggle-slider"></div>
        </div>
      </div>

      <div class="setting-item">
        <span class="setting-label">Duplicate sheet before to translate</span>
        <div class="toggle-switch active" id="duplicateSheetToggle" onclick="toggleSetting(SETTING_NAMES.DUPLICATE_SHEET)">
          <div class="toggle-slider"></div>
        </div>
      </div>

      <div class="setting-item">
        <span class="setting-label">Apply background color to edited cells</span>
        <div class="toggle-switch active" id="backgroundColorToggle" onclick="toggleSetting(SETTING_NAMES.BACKGROUND_COLOR)">
          <div class="toggle-slider"></div>
        </div>
      </div>
    </div>

    <!-- About Information -->
    <div class="about-info">
      Google Spreadsheet Translation Extension v1.0 - Translate your spreadsheet content easily!
    </div>
  </div>

  <!-- Help Overlay -->
  <div id="helpOverlay" class="help-overlay" style="display: none;">
    <div class="help-content">
      <div class="help-header">
        <h2>Help & Instructions</h2>
        <button class="help-close" onclick="closeHelp()">&times;</button>
      </div>
      <div class="help-body">
        <h3>How to Use the Translation Extension:</h3>
        <ol>
          <li><strong>Select Source Language:</strong> Choose the language of your current content, or use "Auto detect"
            to automatically identify the language.</li>
          <li><strong>Select Target Language:</strong> Choose the language you want to translate to.</li>
          <li><strong>Click TRANSLATE:</strong> The extension will translate your selected content.</li>
        </ol>

        <h3>Advanced Settings:</h3>
        <ul>
          <li><strong>Translate full sheet:</strong> Translate the entire spreadsheet instead of just selected cells.
          </li>
          <li><strong>Duplicate sheet before translate:</strong> Create a copy of your sheet before translating to
            preserve the original.</li>
          <li><strong>Apply background color to edited cells:</strong> Highlight translated cells with a background
            color for easy identification.</li>
        </ul>

        <h3>Tips:</h3>
        <ul>
          <li>Make sure you have selected the cells you want to translate before clicking TRANSLATE.</li>
          <li>Use "Auto detect" for source language when you're unsure of the original language.</li>
          <li>Enable "Duplicate sheet" to keep your original data safe.</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="footer">
    <div class="footer-links">
      <a href="#" onclick="showHelp()">Need help?</a>
    </div>
  </div>

  <?!= include('Javascript'); ?>
  <script>
  </script>
</body>

</html>